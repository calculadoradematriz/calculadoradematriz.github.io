function y(e,t){return t=t||1,Math.sign(t)===-1&&(e=-e,t=-t),{num:e,den:t,add:n=>y(e*n.den+t*n.num,t*n.den),sub:n=>y(e*n.den-t*n.num,t*n.den),mul:n=>M(n,e,t),div:n=>{let i=n.den,r=n.num;return M(y(i,r),e,t)}}}var z=y;function M(e,t,n){let i=Math.sign(t)*Math.sign(e.num),r=Math.sign(n)*Math.sign(e.den);return Math.abs(t)===Math.abs(e.den)&&Math.abs(n)===Math.abs(e.num)?(i=i,r=r):Math.abs(n)===Math.abs(e.num)?(i=i*Math.abs(t),r=r*Math.abs(e.den)):Math.abs(t)===Math.abs(e.den)?(i=i*Math.abs(e.num),r=r*Math.abs(n)):(i=t*e.num,r=n*e.den),y(i,r)}function w(e){return{top:t=>j(e,t),bottom:t=>k(e,t),left:t=>x(e,t),right:t=>E(e,t)}}var _=w;function j(e,t){let n=e[0].length||e.length,i=t[t.length-1].length||t.length;if(n!==i)return e;Array.isArray(e[0])||(e=[e]),Array.isArray(t[t.length-1])||(t=[t]);for(let r=t.length-1;r>=0;r--)e.unshift(t[r].map(l=>l));return e}function k(e,t){let n=e[e.length-1].length||e.length,i=t[0].length||t.length;if(n!==i)return e;Array.isArray(e[e.length-1])||(e=[e]),Array.isArray(t[0])||(t=[t]);for(let r=0;r<t.length;r++)e.push(t[r].map(l=>l));return e}function x(e,t){let n=e.length,i=t.length;if(!Array.isArray(e[0])&&!Array.isArray(t[0]))return e.unshift.apply(e,t),e;if(n!==i)return e;for(let r=0;r<n;r++)e[r].unshift.apply(e[r],t[r].map(l=>l));return e}function E(e,t){let n=e.length,i=t.length;if(!Array.isArray(e[0])&&!Array.isArray(t[0]))return e.push.apply(e,t),e;if(n!==i)return e;for(let r=0;r<n;r++)e[r].push.apply(e[r],t[r].map(l=>l));return e}const d=z,H=_;function W(e){if(!Array.isArray(e))throw new Error("Input should be of type array");return Object.assign(function(){let n=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);return I(e,n)},q(e))}function q(e){return{size:()=>c(e),add:t=>p(e,t,F),sub:t=>p(e,t,G),mul:t=>p(e,t,v),div:t=>p(e,t,J),prod:t=>R(e,t),trans:()=>B(e),set:function(){let t=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);return{to:n=>N(e,n,t)}},det:()=>K(e),inv:()=>L(e),merge:H(e),map:t=>P(e,t),equals:t=>U(e,t)}}var V=W;function c(e){let t=[];for(;Array.isArray(e);)t.push(e.length),e=e[0];return t}function A(e){return c(e).length}function I(e,t){return t.length===0?e:O(e,t)}function O(e,t){let n=A(e);for(let i=0;i<n;i++){let r=t[i];if(r===void 0)break;Array.isArray(r)?e=$(e,r,i):Number.isInteger(r)&&(A(e)>1&&i>0?e=e.map(function(l){return[l[r]]}):e=e[r])}return e}function $(e,t,n){if(t.length){if(t.length===2){let i=t[0]>t[1],r=i?t[1]:t[0],l=i?t[0]:t[1];return A(e)>1&&n>0?e.map(function(o){return i?o.slice(r,l+1).reverse():o.slice(r,l+1)}):(e=e.slice(r,l+1),i&&e.reverse()||e)}}else return e}function N(e,t,n){let i=C(e),r=n[0],l=r[0]||0,o=r[1]&&r[1]+1||e.length;if(!Array.isArray(r)&&n.length===1)i[r].fill(t);else if(n.length===1)for(let u=l;u<o;u++)i[u].fill(t);for(let u=1;u<n.length;u++){let f=Array.isArray(n[u])?n[u][0]||0:n[u],s=Array.isArray(n[u])?n[u][1]&&n[u][1]+1||e[0].length:n[u]+1;if(!Array.isArray(r))i[r].fill(t,f,s);else for(let h=l;h<o;h++)i[h].fill(t,f,s)}return i}function p(e,t,n){let i=[],r=t();for(let l=0;l<e.length;l++){let o=e[l],u=r[l];i.push(o.map(function(f,s){return n(f,u[s])}))}return i}function R(e,t){let n=e,i=t(),r=c(n),l=c(i),o=[];if(r[1]===l[0])for(let u=0;u<r[0];u++){o[u]=[];for(let f=0;f<l[1];f++)for(let s=0;s<r[1];s++)o[u][f]===void 0&&(o[u][f]=0),o[u][f]+=v(n[u][s],i[s][f])}return o}function B(e){let t=e,n=c(e),i=[];for(let r=0;r<n[0];r++)for(let l=0;l<n[1];l++)Array.isArray(i[l])?i[l].push(t[r][l]):i[l]=[t[r][l]];return i}function C(e){let t=[];for(let n=0;n<e.length;n++)t.push(e[n].slice(0));return t}function F(e,t){return e+t}function G(e,t){return e-t}function v(e,t){return e*t}function J(e,t){return e/t}function K(e){let t=a(e),n=c(e),i=d(1),r=1;for(let l=0;l<n[0]-1;l++)for(let o=l+1;o<n[0];o++){if(t[o][l].num===0)continue;if(t[l][l].num===0){g(t,l,o),r=-r;continue}let u=t[o][l].div(t[l][l]);u=d(Math.abs(u.num),u.den),Math.sign(t[o][l].num)===Math.sign(t[l][l].num)&&(u=d(-u.num,u.den));for(let f=0;f<n[1];f++)t[o][f]=u.mul(t[l][f]).add(t[o][f])}return i=t.reduce((l,o,u)=>l.mul(o[u]),d(1)),r*i.num/i.den}function g(e,t,n){let i=e[t];e[t]=e[n],e[n]=i}function L(e){let t=a(e),n=c(e),i=a(T(n[0])),r=0,l=0;for(;l<n[0];){if(t[r][l].num===0)for(let u=r+1;u<n[0];u++)t[u][l].num!==0&&(g(t,r,u),g(i,r,u));if(t[r][l].num!==0){if(t[r][l].num!==1||t[r][l].den!==1){let u=d(t[r][l].num,t[r][l].den);for(let f=0;f<n[1];f++)t[r][f]=t[r][f].div(u),i[r][f]=i[r][f].div(u)}for(let u=r+1;u<n[0];u++){let f=t[u][l];for(let s=0;s<n[1];s++)t[u][s]=t[u][s].sub(f.mul(t[r][s])),i[u][s]=i[u][s].sub(f.mul(i[r][s]))}}r+=1,l+=1}let o=n[0]-1;if(t[o][o].num!==1||t[o][o].den!==1){let u=d(t[o][o].num,t[o][o].den);for(let f=0;f<n[1];f++)t[o][f]=t[o][f].div(u),i[o][f]=i[o][f].div(u)}for(let u=n[0]-1;u>0;u--)for(let f=u-1;f>=0;f--){let s=d(-t[f][u].num,t[f][u].den);for(let h=0;h<n[1];h++)t[f][h]=s.mul(t[u][h]).add(t[f][h]),i[f][h]=s.mul(i[u][h]).add(i[f][h])}return Q(i)}function P(e,t){const n=c(e),i=[];for(let r=0;r<n[0];r++)if(Array.isArray(e[r])){i[r]=[];for(let l=0;l<n[1];l++)i[r][l]=t(e[r][l],[r,l],e)}else i[r]=t(e[r],[r,0],e);return i}function a(e){let t=[];return e.forEach((n,i)=>{t.push(n.map(r=>d(r)))}),t}function Q(e){let t=[];return e.forEach((n,i)=>{t.push(n.map(r=>r.num/r.den))}),t}function S(e,t){let n=2;for(;n>0;){for(var i=[],r=0;r<e;r++)Array.isArray(t)?i.push(Object.assign([],t)):i.push(t);t=i,n-=1}return t}function T(e){let t=S(e,0);return t.forEach((n,i)=>{n[i]=1}),t}function U(e,t){let n=e,i=t(),r=c(n),l=c(i);return r.every((o,u)=>o===l[u])?n.every((o,u)=>o.every((f,s)=>Math.abs(f-i[u][s])<1e-10)):!1}export{V as l};
